# 贡献者快速上手

本页为中文简要指引，补充根目录 `AGENTS.md` 的关键点，帮助你快速开始开发、测试与提交更改。

## 目录约定
- `utilities/`：核心客户端与工具（API 封装、下载器、转换器）。复用逻辑放这里。
- `examples/`：可运行示例；行为或参数变更时同步更新。
- `export_wiznotes/` 与顶层 `*.py`：批量导入/导出/清理入口脚本。
- `docs/`：中文功能指南；新增能力需附一篇简短 How‑To。
- `test/`：pytest 测试；产物写入 `output/` 或 `test_output/`（已被忽略）。

## 本地开发与测试
- 新建虚拟环境（Windows）：`python -m venv .venv` → `.venv\\Scripts\\activate`
- 安装依赖：`pip install -r requirements.txt`
- 运行测试：`pytest`；定点：`pytest test/test_toutiao_fix.py -k case`
- 查看 CLI 帮助：`python urls_to_siyuan.py --help`
- 终端编码：每次会话先执行 `[Console]::OutputEncoding = [System.Text.Encoding]::UTF8`

## 编码与日志
- Python 3.7+，4 空格缩进；函数/模块 `snake_case`，类 `PascalCase`，常量 `UPPER_SNAKE_CASE`。
- 新增参数遵循 `argparse` 风格；输出清晰的 INFO 日志。
- 文件统一 UTF‑8（无 BOM）；提交前若发现非 UTF‑8 请先转换。

## 测试规范
- 使用 pytest，文件命名 `test_<feature>.py`。
- Mock 外部 HTTP/SiYuan API；对生成文件用“元数据断言”（数量、标题、路径）。
- 关注边界编码/来源：飞书、头条、七牛等。

## 提交与 PR
- Commit 简短、祈使句（中/英均可）。
- PR 需：意图说明、测试证据（`pytest` 输出或手动运行结果）、涉及的配置/文档更新、样例输出路径（如 `output/...`）。
- 涉及非小型数据迁移前请先请求评审。

## 新功能 How‑To 模板
- 概要：一句话说明用途与适用场景。
- 前置准备：必须的环境变量/令牌（勿提交 `.env`）。
- 命令示例：
  - 安装：`pip install -r requirements.txt`
  - 运行：`python <script>.py --flag value`
- 输出位置：`output/` 或 `test_output/`，并附示例路径。
- 回滚/清理：说明如何安全撤回或清理产物。

## 安全提示
- 不要提交个人令牌与敏感配置；在 `README.md` 文档化环境变量并在代码给出安全默认值。
- 破坏性脚本（如 `delete_qiniu_files.py`）需二次确认并在文档中强调备份流程。

